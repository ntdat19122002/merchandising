<template>
    <div style="width: 100%;" v-if="is_has_plan_product_groups">
        <div
            style="display: flex; justify-content: space-between; margin-bottom: 26px;"
            :class=" scrollPosition !== 0 ? 'pv-sticky-menu':'pv-not-sticky-menu'">
            <div class="pv-flex-row pv-center-align" style="gap: 8px">
                <div class="pv-page-title">Product group</div>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                     xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3ZM1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12ZM11 8C11 7.44772 11.4477 7 12 7H12.01C12.5623 7 13.01 7.44772 13.01 8C13.01 8.55228 12.5623 9 12.01 9H12C11.4477 9 11 8.55228 11 8ZM12 11C12.5523 11 13 11.4477 13 12V16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16V12C11 11.4477 11.4477 11 12 11Z"
                          fill="#666666"/>
                </svg>
            </div>
            <div class="pv-flex-row" style="gap: 10px">
                <div style="gap: 16px; display: flex" v-if="isOptionChange">
                    <div class="pv-btn-secondary pv-button-style pv-flex-row-center" style="gap: 8px"
                         @click="cancelVariantOptionsStyle">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M11.2542 1.92085C11.3681 1.80698 11.5173 1.75003 11.6666 1.75C11.8159 1.74997 11.9652 1.80693 12.0791 1.92085C12.307 2.14866 12.307 2.51801 12.0791 2.74581L7.82486 7L12.079 11.2542C12.3069 11.482 12.3069 11.8513 12.079 12.0791C11.9651 12.193 11.8159 12.25 11.6666 12.25C11.5173 12.25 11.368 12.193 11.2541 12.0791L6.9999 7.82496L2.74638 12.0791C2.63234 12.1932 2.48281 12.2501 2.33333 12.25C2.18424 12.2499 2.03518 12.1929 1.92143 12.0791C1.69362 11.8513 1.69362 11.482 1.92143 11.2542L6.17494 7L1.92085 2.74581C1.69305 2.51801 1.69305 2.14866 1.92085 1.92085C2.03473 1.80698 2.18398 1.75003 2.33323 1.75C2.48255 1.74997 2.63188 1.80693 2.74581 1.92085L6.9999 6.17504L11.2542 1.92085Z"
                                fill="#F5222D"/>
                        </svg>
                        <div style="color: #F5222D;">Cancel</div>
                    </div>
                    <div class="pv-btn-primary pv-flex-row-center" style="gap: 8px"
                         @click="saveVariantOptionsStyle('Option configuration has been saved successfully.')">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M12.5828 4.23533C12.4778 4.06616 12.3612 3.94364 12.122 3.70448L10.3545 1.9428C10.3545 1.9428 10.3253 1.91366 10.3137 1.902L10.302 1.89032C10.0862 1.66865 9.95199 1.54035 9.75366 1.41202C9.57283 1.31285 9.40366 1.24281 9.27533 1.21947C9.07116 1.16697 8.87866 1.16699 8.56949 1.16699H4.55616C4.39866 1.16699 4.25866 1.16699 4.11866 1.16699C4.09533 1.16699 4.07199 1.16699 4.04866 1.16699C3.31949 1.17283 2.85866 1.20786 2.45033 1.41786C2.01283 1.63369 1.64533 2.00119 1.42366 2.43869C1.16699 2.94036 1.16699 3.47702 1.16699 4.55035V9.4503C1.16699 10.5236 1.16699 11.0604 1.41783 11.5562C1.63949 11.9995 2.00699 12.3612 2.43866 12.577C2.85283 12.787 3.31366 12.8278 4.04283 12.8337C4.05449 12.8337 4.07199 12.8337 4.08366 12.8337C4.22949 12.8337 4.38116 12.8337 4.55033 12.8337H9.45033C9.61949 12.8337 9.76533 12.8337 9.91699 12.8337C9.92866 12.8337 9.94616 12.8337 9.95782 12.8337C10.687 12.8278 11.1478 12.7928 11.5562 12.5828C11.9937 12.367 12.3612 11.9995 12.5828 11.562C12.8395 11.0661 12.8395 10.5236 12.8395 9.45614V5.44864C12.8395 5.13947 12.8395 4.947 12.7928 4.74283C12.7462 4.56783 12.6762 4.39284 12.5828 4.24117V4.23533ZM4.67283 2.33366H8.56366C8.78533 2.33366 8.91949 2.33368 9.01283 2.35701C9.04199 2.35701 9.08866 2.38033 9.14699 2.40949C9.19366 2.43866 9.24616 2.48535 9.33949 2.57868V3.73367C9.33949 3.89701 9.33949 4.06031 9.36866 4.07198C9.32199 4.08365 9.15283 4.08366 8.98949 4.08366H5.02283C4.85949 4.08366 4.69616 4.08368 4.68449 4.10701C4.67283 4.06035 4.67283 3.89117 4.67283 3.72783V2.32782V2.33366ZM9.33949 11.667H4.67283V8.51698C4.67283 8.35364 4.67283 8.19034 4.64366 8.17867C4.69033 8.167 4.85949 8.16699 5.02283 8.16699H8.98949C9.15283 8.16699 9.32199 8.16697 9.32783 8.14364C9.33949 8.1903 9.33949 8.35948 9.33949 8.51698V11.667ZM11.6728 9.4503C11.6728 10.3078 11.6728 10.7803 11.5445 11.0312C11.4337 11.2528 11.2528 11.4278 11.0312 11.5387C10.9145 11.6028 10.7395 11.632 10.5003 11.6495V8.51698C10.5003 8.13781 10.5003 7.88698 10.372 7.64198C10.2553 7.41448 10.0745 7.22781 9.85866 7.12864C9.60783 7.00031 9.35699 7.00033 8.97783 7.00033H5.01116C4.63199 7.00033 4.38116 7.0003 4.14199 7.1228C3.92033 7.2278 3.73366 7.41447 3.62283 7.63614C3.49449 7.88697 3.49449 8.13781 3.49449 8.51698V11.6495C3.25533 11.632 3.08033 11.6028 2.95783 11.5387C2.74199 11.4337 2.56699 11.2528 2.45033 11.0312C2.32199 10.7803 2.32199 10.3136 2.32199 9.45614V4.55619C2.32199 3.69869 2.32199 3.22614 2.45033 2.97531C2.56116 2.75364 2.74199 2.57865 2.96366 2.46781C3.08033 2.40365 3.25533 2.37451 3.49449 2.35701V3.73951C3.49449 4.11868 3.49449 4.37535 3.62283 4.61451C3.73949 4.84201 3.92616 5.02868 4.13033 5.12785C4.38116 5.25618 4.63199 5.25616 5.01116 5.25616H8.97783C9.35699 5.25616 9.60783 5.25619 9.84699 5.13369C10.0687 5.02869 10.2553 4.84202 10.3662 4.62035C10.4945 4.37535 10.4945 4.12452 10.4945 3.74535L11.317 4.5678C11.457 4.7078 11.5445 4.79536 11.5737 4.84786C11.6028 4.90036 11.632 4.95864 11.6437 5.01698C11.6612 5.08698 11.6612 5.22114 11.6612 5.44864V9.45614L11.6728 9.4503Z"
                                fill="white"/>
                        </svg>
                        <div class="pv-button-style" style="color: #FFF">Save</div>
                    </div>
                </div>
                <div v-else-if="list_option.length >= 0 && list_option.length < 100"
                     class="pv-btn-primary pv-flex-row-center" style="gap: 8px"
                     @click="openCreateProductGroup">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M6.99935 1.16699C6.67852 1.16699 6.41602 1.42949 6.41602 1.75033V6.41699H1.74935C1.42852 6.41699 1.16602 6.67949 1.16602 7.00033C1.16602 7.32116 1.42852 7.58366 1.74935 7.58366H6.41602V12.2503C6.41602 12.5712 6.67852 12.8337 6.99935 12.8337C7.32018 12.8337 7.58268 12.5712 7.58268 12.2503V7.58366H12.2493C12.5702 7.58366 12.8327 7.32116 12.8327 7.00033C12.8327 6.67949 12.5702 6.41699 12.2493 6.41699H7.58268V1.75033C7.58268 1.42949 7.32018 1.16699 6.99935 1.16699Z"
                            fill="white"/>
                    </svg>
                    <div class="pv-button-style" style="color: #FFF">Create product group</div>
                </div>
                <div v-else class="pv-btn-primary pv-flex-row-center" style="gap: 8px;cursor:not-allowed;">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M6.99935 1.16699C6.67852 1.16699 6.41602 1.42949 6.41602 1.75033V6.41699H1.74935C1.42852 6.41699 1.16602 6.67949 1.16602 7.00033C1.16602 7.32116 1.42852 7.58366 1.74935 7.58366H6.41602V12.2503C6.41602 12.5712 6.67852 12.8337 6.99935 12.8337C7.32018 12.8337 7.58268 12.5712 7.58268 12.2503V7.58366H12.2493C12.5702 7.58366 12.8327 7.32116 12.8327 7.00033C12.8327 6.67949 12.5702 6.41699 12.2493 6.41699H7.58268V1.75033C7.58268 1.42949 7.32018 1.16699 6.99935 1.16699Z"
                            fill="white"/>
                    </svg>
                    <div class="pv-button-style" style="color: #FFF">Create product group</div>
                </div>
            </div>
        </div>

        <div style="padding: 0 40px">
            <div v-if="!closeMakeSure"
                 style="padding: 16px; border-radius: 10px; background: #FAFAFA;justify-content: space-between;margin-bottom: 24px"
                 class="pv-flex-row">
                <div style="gap: 12px" class="pv-flex-row">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                              d="M12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3ZM1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12ZM11 8C11 7.44772 11.4477 7 12 7H12.01C12.5623 7 13.01 7.44772 13.01 8C13.01 8.55228 12.5623 9 12.01 9H12C11.4477 9 11 8.55228 11 8ZM12 11C12.5523 11 13 11.4477 13 12V16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16V12C11 11.4477 11.4477 11 12 11Z"
                              fill="#666666"/>
                    </svg>
                    <div class="pv-flex-column" style="gap: 8px">
                        <div class="pv-make-sure">
                            Make sure Product group is activated on your theme
                        </div>
                        <div class="pv-make-sure-line">
                            For the Product group to be displayed properly on your store, please Go to <a
                            target="_blank" :href="'https://' + store_url + '/admin/themes/current/editor'"
                            class="pv-link">Link theme section</a> and select product to add 'NestScale Product group'
                            block into
                        </div>
                    </div>
                </div>
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"
                     style="cursor: pointer"
                     @click="$emit('setCloseMakeSure')">
                    <path
                        d="M12.8619 2.19526C12.9921 2.06512 13.1626 2.00003 13.3332 2C13.5039 1.99997 13.6745 2.06506 13.8047 2.19526C14.0651 2.45561 14.0651 2.87772 13.8047 3.13807L8.94269 8L13.8046 12.8619C14.065 13.1223 14.065 13.5444 13.8046 13.8047C13.6744 13.9349 13.5038 14 13.3332 14C13.1626 14 12.992 13.9349 12.8618 13.8047L7.99988 8.94281L3.13872 13.8047C3.00838 13.9351 2.8375 14.0002 2.66667 14C2.49627 13.9998 2.32592 13.9347 2.19591 13.8047C1.93557 13.5444 1.93557 13.1223 2.19591 12.8619L7.05708 8L2.19526 3.13807C1.93491 2.87772 1.93491 2.45561 2.19526 2.19526C2.32541 2.06512 2.49597 2.00003 2.66655 2C2.8372 1.99997 3.00787 2.06506 3.13807 2.19526L7.99988 7.05719L12.8619 2.19526Z"
                        fill="#666666"/>
                </svg>
            </div>
            <div>
                <div v-if="list_option.length === 0" class="pv-flex-column pv-justify-center pv-center-align"
                     style="padding-top: 15%;gap: 40px">
                    <svg width="360" height="240" viewBox="0 0 360 240" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_1072_22553)">
                            <path
                                d="M127.012 174.576C123.298 174.576 120.287 171.565 120.287 167.85V6.72525C120.287 3.01115 123.298 0 127.012 0H352.213C355.927 0 358.938 3.01115 358.938 6.72525V166.948C358.938 171.162 355.523 174.577 351.309 174.577H127.012V174.576Z"
                                fill="white"/>
                            <path
                                d="M277.255 103.577L222.576 103.577C222.417 103.577 222.287 103.448 222.287 103.288C222.287 103.128 222.416 103 222.576 103L277.255 103C277.414 103 277.544 103.129 277.544 103.289C277.544 103.449 277.415 103.577 277.255 103.577Z"
                                fill="black"/>
                            <path
                                d="M249.71 130.968L249.71 76.2885C249.71 76.1298 249.839 76 249.999 76C250.159 76 250.287 76.1285 250.287 76.2885L250.287 130.968C250.287 131.127 250.158 131.256 249.998 131.256C249.838 131.256 249.71 131.128 249.71 130.968Z"
                                fill="black"/>
                            <path
                                d="M351.796 175.153H127.5C123.633 175.153 120.486 172.007 120.486 168.139V7.01377C120.486 3.14623 123.633 0 127.5 0H352.701C356.568 0 359.714 3.14623 359.714 7.01377V167.237C359.714 171.603 356.163 175.154 351.797 175.154L351.796 175.153ZM127.5 0.577049C123.951 0.577049 121.063 3.46492 121.063 7.01377V168.14C121.063 171.689 123.951 174.577 127.5 174.577H351.797C355.844 174.577 359.137 171.284 359.137 167.237V7.01377C359.137 3.46492 356.25 0.577049 352.701 0.577049H127.5Z"
                                fill="black"/>
                            <path
                                d="M323.077 13.7795C325.18 13.7458 326.858 12.0135 326.824 9.91034C326.79 7.80722 325.058 6.12969 322.955 6.16346C320.851 6.19723 319.174 7.92952 319.208 10.0326C319.241 12.1358 320.974 13.8133 323.077 13.7795Z"
                                fill="#E2EAFF"/>
                            <path
                                d="M334.233 13.7354C336.335 13.6778 337.993 11.9266 337.935 9.82399C337.878 7.72139 336.127 6.06361 334.024 6.12124C331.921 6.17887 330.264 7.93008 330.321 10.0327C330.379 12.1353 332.13 13.7931 334.233 13.7354Z"
                                fill="#E2EAFF"/>
                            <path
                                d="M345.277 13.741C347.38 13.7223 349.07 12.0021 349.051 9.89878C349.032 7.79547 347.312 6.10558 345.209 6.1243C343.105 6.14303 341.416 7.86327 341.434 9.96658C341.453 12.0699 343.173 13.7598 345.277 13.741Z"
                                fill="#E2EAFF"/>
                            <path
                                d="M353.353 17.8515H126.845C126.686 17.8515 126.557 17.7229 126.557 17.5629C126.557 17.4029 126.685 17.2744 126.845 17.2744H353.353C353.512 17.2744 353.642 17.4029 353.642 17.5629C353.642 17.7229 353.513 17.8515 353.353 17.8515Z"
                                fill="black"/>
                            <path d="M353.287 28H319.287V54H353.287V28Z" fill="#FFB2B2"/>
                            <path d="M353.287 60H319.287V86H353.287V60Z" fill="#FFB2B2"/>
                            <path d="M353.287 92H319.287V118H353.287V92Z" fill="#FFB2B2"/>
                            <path
                                d="M28.5447 234.193C28.504 234.193 28.4633 234.185 28.424 234.167C28.2797 234.1 28.2155 233.929 28.2824 233.784L64.0571 156.058C64.124 155.914 64.2945 155.849 64.44 155.916C64.5843 155.983 64.6486 156.154 64.5817 156.299L28.8056 234.025C28.7571 234.131 28.6522 234.193 28.5433 234.193H28.5447Z"
                                fill="black"/>
                            <path
                                d="M27.9116 239.646C29.2714 239.325 30.1136 237.962 29.7927 236.603C29.4717 235.243 28.1092 234.401 26.7493 234.722C25.3895 235.043 24.5473 236.405 24.8682 237.765C25.1892 239.125 26.5517 239.967 27.9116 239.646Z"
                                fill="black"/>
                            <path
                                d="M129.409 234.193C129.301 234.193 129.196 234.131 129.147 234.025L93.3724 156.299C93.3055 156.155 93.3685 155.983 93.5141 155.916C93.6583 155.849 93.8301 155.914 93.897 156.058L129.672 233.784C129.739 233.928 129.676 234.1 129.53 234.167C129.491 234.185 129.45 234.193 129.409 234.193Z"
                                fill="black"/>
                            <path
                                d="M128.08 237.182C128.08 238.58 129.213 239.712 130.61 239.712C132.007 239.712 133.14 238.579 133.14 237.182C133.14 235.785 132.007 234.652 130.61 234.652C129.213 234.652 128.08 235.785 128.08 237.182Z"
                                fill="black"/>
                            <path
                                d="M78.976 198.518C104.462 198.518 125.122 177.858 125.122 152.372C125.122 126.887 104.462 106.227 78.976 106.227C53.4903 106.227 32.8301 126.887 32.8301 152.372C32.8301 177.858 53.4903 198.518 78.976 198.518Z"
                                fill="white"/>
                            <path
                                d="M78.9755 198.807C53.3713 198.807 32.541 177.976 32.541 152.373C32.541 126.769 53.3713 105.938 78.9755 105.938C104.58 105.938 125.41 126.769 125.41 152.373C125.41 177.976 104.58 198.807 78.9755 198.807ZM78.9755 106.516C53.69 106.516 33.1181 127.087 33.1181 152.373C33.1181 177.658 53.69 198.23 78.9755 198.23C104.261 198.23 124.833 177.658 124.833 152.373C124.833 127.087 104.261 106.516 78.9755 106.516Z"
                                fill="black"/>
                            <path
                                d="M139.93 128.465L133.157 102.901C131.4 96.2648 125.747 91.394 118.925 90.6268C109.827 89.6038 96.4383 88.4222 83.1831 88.4287C72.0761 88.434 62.442 96.1402 59.9409 106.963C58.0629 115.088 56.2203 125.003 55.6668 134.385C55.0924 144.131 64.8315 151.172 73.8978 147.553L103.707 135.654L115.958 133.799L139.93 128.465Z"
                                fill="white"/>
                            <path
                                d="M68.9449 148.798C66.1396 148.798 63.3658 147.923 61.0051 146.219C57.2058 143.478 55.1022 139.047 55.3776 134.368C55.8484 126.395 57.2884 117.153 59.6583 106.897C60.8832 101.598 63.9009 96.8082 68.1527 93.4141C72.4098 90.016 77.7476 88.1432 83.1811 88.1406H83.2939C96.5949 88.1406 110.022 89.3367 118.956 90.3413C125.95 91.1282 131.634 96.0291 133.435 102.828L140.207 128.392C140.227 128.468 140.215 128.548 140.174 128.617C140.134 128.684 140.067 128.731 139.991 128.748L116.019 134.082L103.781 135.935L74.0033 147.821C72.3613 148.476 70.6472 148.798 68.9436 148.798H68.9449ZM83.2952 88.7164H83.1824C72.1541 88.7216 62.7114 96.2508 60.2209 107.026C57.8576 117.25 56.4215 126.461 55.9533 134.4C55.6884 138.883 57.7028 143.126 61.3422 145.75C64.975 148.37 69.6282 148.943 73.7895 147.283L103.598 135.384C103.619 135.376 103.64 135.369 103.663 135.367L115.914 133.512L139.574 128.248L132.879 102.973C131.139 96.4069 125.65 91.6724 118.893 90.9118C109.975 89.9085 96.5687 88.7151 83.2952 88.7151V88.7164Z"
                                fill="black"/>
                            <path
                                d="M78.3175 126.476C78.2978 126.476 78.2782 126.474 78.2585 126.469C78.1024 126.436 78.0027 126.284 78.0355 126.128L82.2074 106.169C82.2402 106.013 82.3936 105.913 82.5484 105.946C82.7044 105.978 82.8041 106.131 82.7713 106.287L78.5995 126.246C78.5706 126.382 78.4513 126.476 78.3175 126.476Z"
                                fill="black"/>
                            <path
                                d="M114.561 129.257C114.452 129.257 114.347 129.195 114.299 129.089C111.008 121.956 106.299 120.558 99.7622 120.622C93.0763 120.685 74.3784 128.65 74.1896 128.731C74.044 128.794 73.8735 128.726 73.8106 128.579C73.7476 128.432 73.8158 128.263 73.9627 128.2C74.7352 127.869 92.9543 120.109 99.7557 120.045C106.328 119.981 111.412 121.456 114.822 128.846C114.889 128.991 114.826 129.162 114.68 129.229C114.641 129.248 114.6 129.255 114.56 129.255L114.561 129.257Z"
                                fill="black"/>
                            <path
                                d="M107.874 132.266C107.738 132.266 107.616 132.167 107.591 132.028C107.128 129.468 105.25 127.235 102.808 126.338C102.659 126.283 102.583 126.117 102.636 125.968C102.691 125.818 102.857 125.741 103.006 125.796C105.636 126.763 107.658 129.168 108.158 131.926C108.187 132.083 108.082 132.233 107.926 132.262C107.909 132.264 107.892 132.267 107.874 132.267V132.266Z"
                                fill="black"/>
                            <path
                                d="M111.708 130.725C111.569 130.725 111.447 130.624 111.423 130.483C110.988 127.792 109.195 125.378 106.743 124.185C106.6 124.115 106.539 123.942 106.609 123.799C106.678 123.656 106.852 123.596 106.995 123.666C109.612 124.939 111.527 127.516 111.993 130.39C112.018 130.547 111.911 130.695 111.754 130.72C111.738 130.723 111.722 130.724 111.708 130.724V130.725Z"
                                fill="black"/>
                            <path
                                d="M116.462 132.906C116.447 132.906 116.431 132.906 116.415 132.902C116.258 132.876 116.152 132.728 116.178 132.571L120.365 107.457C120.392 107.3 120.54 107.194 120.697 107.22C120.855 107.246 120.961 107.394 120.935 107.552L116.747 132.665C116.723 132.807 116.601 132.906 116.462 132.906Z"
                                fill="black"/>
                            <path
                                d="M99.0316 74.4261L94.9502 88.434L91.8105 88.5782C91.8105 88.5782 99.9483 96.8248 109.332 89.6668L106.557 88.4274L108.507 79.8215L99.0316 74.4248V74.4261Z"
                                fill="white"/>
                            <path
                                d="M101.38 92.8604C95.7213 92.8604 91.6623 88.8408 91.6046 88.7817C91.5246 88.7004 91.4996 88.5798 91.5416 88.4735C91.5836 88.3673 91.6833 88.2952 91.7974 88.2899L94.7312 88.1549L98.7548 74.345C98.7797 74.2598 98.8413 74.1916 98.924 74.1588C99.0066 74.126 99.0984 74.1312 99.1745 74.1758L108.65 79.5726C108.76 79.6355 108.817 79.7627 108.789 79.8873L106.891 88.2624L109.451 89.4047C109.544 89.4467 109.609 89.5332 109.62 89.6342C109.632 89.7352 109.59 89.8349 109.509 89.8965C106.629 92.0932 103.854 92.8591 101.383 92.8591L101.38 92.8604ZM92.5239 88.8355C93.3108 89.5017 94.9672 90.7463 97.1705 91.5437C101.178 92.9942 105.077 92.3844 108.764 89.7299L106.439 88.6926C106.313 88.6362 106.245 88.4998 106.275 88.366L108.178 79.9686L99.2059 74.8591L95.2269 88.5168C95.1928 88.6349 95.0866 88.7188 94.9633 88.724L92.5239 88.8355Z"
                                fill="black"/>
                            <path
                                d="M113.58 69.6761C113.58 69.6761 124.595 66.581 124.483 59.8413C124.372 53.1016 119.388 53.9226 111.601 53.878C103.089 53.8295 94.0095 53.3482 93.3092 63.7587C92.6089 74.1679 101.893 76.9967 101.893 76.9967L113.581 69.6774L113.58 69.6761Z"
                                fill="black"/>
                            <path
                                d="M114.664 76.8183C114.334 78.2138 113.927 79.6511 112.983 80.7292C111.481 82.4446 108.824 82.8551 106.694 82.0433C104.589 81.242 102.937 79.3442 102.433 77.1488C100.706 77.002 99.0679 76.0315 98.1105 74.5862C97.4954 73.6577 97.1754 72.3856 97.7734 71.4452C98.2941 70.6256 99.3852 70.3095 100.344 70.4616C101.304 70.6138 102.155 71.1515 102.935 71.7311C104.575 71.4334 100.854 65.4269 108.233 63.4715C109.949 63.0164 112.027 62.7842 113.802 63.0308C115.472 63.2616 115.355 64.3567 115.552 65.8006C116.053 69.4859 115.517 73.2249 114.665 76.8157L114.664 76.8183Z"
                                fill="white"/>
                            <path
                                d="M108.913 82.7383C108.139 82.7383 107.35 82.5993 106.595 82.3121C104.451 81.4963 102.784 79.6301 102.205 77.4137C100.479 77.2026 98.8327 76.194 97.8727 74.7449C97.2472 73.8006 96.8288 72.3973 97.5331 71.2904C98.1586 70.3068 99.4203 70.0222 100.392 70.177C101.385 70.3344 102.252 70.8734 102.978 71.4032C103.15 71.2537 103.142 70.7606 103.116 70.0209C103.044 67.9868 102.922 64.5809 108.16 63.1934C110.105 62.678 112.176 62.5153 113.843 62.7462C115.523 62.9783 115.646 64.076 115.776 65.2367C115.794 65.4058 115.814 65.5816 115.839 65.7626C116.273 68.9534 115.99 72.4865 114.947 76.8839C114.611 78.3003 114.199 79.7796 113.203 80.918C112.171 82.097 110.577 82.7383 108.913 82.7383ZM99.8741 70.7134C99.179 70.7134 98.4209 70.9704 98.0196 71.5999C97.4635 72.4747 97.8518 73.6694 98.3541 74.4262C99.2577 75.7901 100.831 76.7226 102.46 76.8603C102.585 76.8708 102.689 76.9612 102.717 77.0832C103.196 79.1698 104.799 81.0111 106.8 81.7717C108.959 82.594 111.414 82.0852 112.769 80.5363C113.679 79.4963 114.067 78.0957 114.386 76.7488C115.411 72.4235 115.692 68.9573 115.268 65.8386C115.243 65.6524 115.222 65.4727 115.203 65.2996C115.072 64.1311 114.999 63.4871 113.764 63.3167C112.171 63.0963 110.181 63.2537 108.308 63.7508C103.515 65.0216 103.621 68.0183 103.692 69.9999C103.727 71.0058 103.759 71.874 102.989 72.0144C102.911 72.0288 102.829 72.0091 102.765 71.9619C102.068 71.4439 101.23 70.8931 100.3 70.7449C100.163 70.7226 100.02 70.7121 99.8727 70.7121L99.8741 70.7134Z"
                                fill="black"/>
                            <path
                                d="M102.496 75.2733C102.414 75.2733 102.334 75.2392 102.277 75.1736C101.672 74.4733 100.797 74.0117 99.8792 73.9081C99.7205 73.8897 99.6077 73.7468 99.6248 73.5894C99.6431 73.4307 99.7861 73.3166 99.9434 73.3349C101.004 73.4556 102.014 73.9881 102.712 74.7972C102.816 74.9179 102.802 75.1002 102.682 75.2038C102.627 75.251 102.56 75.2733 102.493 75.2733H102.496Z"
                                fill="black"/>
                            <path
                                d="M166.455 132.723L103.088 134.809V130.771C103.088 129.053 104.481 127.661 106.197 127.661H166.455V132.723Z"
                                fill="black"/>
                            <path
                                d="M169.766 130.431H130.652C128.982 130.431 127.755 128.863 128.157 127.242L135.55 97.4215C135.834 96.274 136.864 95.4688 138.045 95.4688H177.159C178.83 95.4688 180.056 97.0373 179.655 98.6583L172.262 128.48C171.977 129.627 170.948 130.433 169.766 130.433V130.431Z"
                                fill="black"/>
                            <path d="M157.323 110.114H153.908L154.738 106.697H158.153L157.323 110.114Z" fill="white"/>
                            <path
                                d="M176.935 218.255L214.825 207.996C216.803 207.461 217.343 204.91 215.752 203.618L207.49 196.911L173.748 207.453L176.935 218.257V218.255Z"
                                fill="white"/>
                            <path
                                d="M176.934 218.544C176.81 218.544 176.694 218.462 176.658 218.336L173.471 207.533C173.426 207.382 173.511 207.223 173.661 207.176L207.403 196.634C207.495 196.605 207.596 196.625 207.67 196.685L215.933 203.392C216.754 204.058 217.128 205.114 216.909 206.149C216.69 207.182 215.92 207.997 214.899 208.274L177.009 218.533C176.984 218.54 176.958 218.544 176.933 218.544H176.934ZM174.106 207.643L177.132 217.904L214.75 207.717C215.572 207.495 216.169 206.864 216.345 206.031C216.522 205.197 216.232 204.38 215.571 203.842L207.429 197.232L174.106 207.643Z"
                                fill="black"/>
                            <path
                                d="M140.889 226.679L142.535 235.64C142.967 237.998 145.022 239.711 147.42 239.711H185.861C188.472 239.711 189.815 236.586 188.018 234.692L176.934 223.008L140.89 226.679H140.889Z"
                                fill="white"/>
                            <path
                                d="M185.861 240H147.42C144.882 240 142.709 238.189 142.25 235.693L140.604 226.73C140.59 226.651 140.609 226.569 140.657 226.505C140.705 226.44 140.779 226.398 140.859 226.39L176.902 222.72C176.991 222.709 177.079 222.743 177.141 222.808L188.226 234.491C189.138 235.453 189.38 236.806 188.856 238.025C188.333 239.242 187.186 239.998 185.86 239.998L185.861 240ZM141.229 226.935L142.818 235.589C143.226 237.811 145.162 239.424 147.42 239.424H185.861C186.952 239.424 187.896 238.801 188.328 237.799C188.758 236.797 188.56 235.682 187.809 234.891L176.821 223.311L141.229 226.936V226.935Z"
                                fill="black"/>
                            <path
                                d="M69.0413 138.48C69.0413 138.48 62.4209 163.281 74.4839 171.092C86.3411 178.77 132.61 173.844 132.61 173.844L140.655 228.998C140.655 228.998 158.435 231.604 179.659 225.905L176.788 209.202L207.396 197.225C207.396 197.225 194.957 166.785 184.853 143.575C178.636 129.292 163.336 121.234 148.04 124.187C135.444 126.62 117.869 130.461 94.471 136.494L69.0413 138.48Z"
                                fill="#F35959"/>
                            <path
                                d="M176.932 207.871C176.792 207.871 176.67 207.769 176.648 207.627C176.576 207.163 169.365 161.034 161.731 150.28C159.242 146.773 155.478 144.554 150.544 143.686C144.108 142.553 137.26 144.121 131.753 147.989L98.1238 171.609C97.994 171.7 97.813 171.669 97.7225 171.538C97.6307 171.408 97.6622 171.227 97.7933 171.136L131.422 147.517C137.054 143.561 144.061 141.957 150.645 143.117C155.733 144.012 159.622 146.31 162.202 149.946C169.915 160.81 176.923 205.635 177.218 207.538C177.243 207.695 177.134 207.842 176.977 207.867C176.962 207.87 176.947 207.871 176.932 207.871Z"
                                fill="black"/>
                            <path
                                d="M55.663 134.384C55.0873 144.129 64.8277 151.171 73.894 147.551L102.682 134.406L83.2816 136.435L56.8224 123.332C56.2912 127.005 55.8794 130.735 55.663 134.384Z"
                                fill="white"/>
                            <path
                                d="M67.1424 148.681C67.1292 148.681 67.1161 148.681 67.1017 148.678C60.1102 147.705 54.9613 141.419 55.377 134.368C55.579 130.949 55.9698 127.222 56.5377 123.292C56.5613 123.134 56.7082 123.026 56.8642 123.048C57.0216 123.07 57.1318 123.217 57.1082 123.374C56.5416 127.289 56.1521 130.999 55.9514 134.403C55.5527 141.155 60.4852 147.175 67.1804 148.107C67.3378 148.13 67.4479 148.275 67.4256 148.433C67.406 148.577 67.2814 148.682 67.141 148.682L67.1424 148.681Z"
                                fill="black"/>
                            <path
                                d="M93.2683 137.948C93.1857 137.948 93.1044 137.912 93.048 137.845C87.2525 130.96 89.1804 123.579 89.2001 123.504C89.2421 123.351 89.4008 123.26 89.5542 123.302C89.7076 123.344 89.7981 123.503 89.7562 123.656C89.7365 123.727 87.8952 130.828 93.4887 137.473C93.5909 137.595 93.5752 137.777 93.4532 137.879C93.3995 137.925 93.3339 137.948 93.267 137.948H93.2683Z"
                                fill="black"/>
                            <path
                                d="M174.444 30.8547C174.444 32.7786 172.883 34.3393 170.959 34.3393C169.035 34.3393 167.475 32.7786 167.475 30.8547C167.475 28.9308 169.035 27.3701 170.959 27.3701C172.883 27.3701 174.444 28.9308 174.444 30.8547Z"
                                fill="#E2EAFF"/>
                            <path
                                d="M184.612 30.8547C184.612 32.7786 183.051 34.3393 181.127 34.3393C179.203 34.3393 177.643 32.7786 177.643 30.8547C177.643 28.9308 179.203 27.3701 181.127 27.3701C183.051 27.3701 184.612 28.9308 184.612 30.8547Z"
                                fill="#E2EAFF"/>
                            <path
                                d="M194.78 30.8547C194.78 32.7786 193.219 34.3393 191.295 34.3393C189.371 34.3393 187.811 32.7786 187.811 30.8547C187.811 28.9308 189.371 27.3701 191.295 27.3701C193.219 27.3701 194.78 28.9308 194.78 30.8547Z"
                                fill="#F35959"/>
                            <path
                                d="M133.857 91.5262C133.698 91.5262 133.568 91.3977 133.568 91.2377V30.4233C133.568 30.2646 133.697 30.1348 133.857 30.1348H162.354C162.513 30.1348 162.643 30.2633 162.643 30.4233C162.643 30.5833 162.514 30.7118 162.354 30.7118H134.144V91.2377C134.144 91.3964 134.016 91.5262 133.856 91.5262H133.857Z"
                                fill="black"/>
                            <path
                                d="M249.881 155C262.182 155 273.939 150.699 283.362 142.683C304.908 124.356 307.381 92.0892 288.875 70.7521C270.369 49.415 237.785 46.9646 216.238 65.2909C205.802 74.1683 199.48 86.5396 198.438 100.125C197.397 113.71 201.761 126.885 210.725 137.22C219.69 147.555 232.183 153.822 245.902 154.848C247.233 154.95 248.559 155.001 249.881 155ZM283.945 74.9466C300.116 93.5898 297.954 121.786 279.127 137.795C270.007 145.557 258.381 149.33 246.395 148.426C234.408 147.523 223.489 142.055 215.657 133.024C207.824 123.992 204.009 112.48 204.92 100.609C205.831 88.7377 211.354 77.9274 220.474 70.17C239.301 54.1615 267.775 56.3024 283.945 74.9466Z"
                                fill="black"/>
                            <path
                                d="M335.605 192C336.334 191.999 337.046 191.778 337.652 191.365C338.258 190.952 338.729 190.366 339.008 189.68C339.286 188.994 339.358 188.24 339.216 187.513C339.073 186.785 338.722 186.117 338.207 185.592L289.551 136.068C288.857 135.378 287.923 134.994 286.953 135C285.982 135.006 285.053 135.401 284.367 136.099C283.681 136.798 283.293 137.743 283.287 138.731C283.281 139.719 283.658 140.669 284.336 141.375L333.002 190.901C333.343 191.249 333.749 191.526 334.196 191.714C334.643 191.903 335.122 192 335.605 192Z"
                                fill="black"/>
                        </g>
                        <defs>
                            <clipPath id="clip0_1072_22553">
                                <rect width="359.426" height="240" fill="white" transform="translate(0.287109)"/>
                            </clipPath>
                        </defs>
                    </svg>
                    <div class="pv-flex-column pv-justify-center pv-center-align" style="gap: 16px">
                        <div class="pv-modal-title">No product groups have been created yet</div>
                        <div class="pv-btn-primary pv-flex-row-center" style="gap: 8px"
                             @click="openCreateProductGroup">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M6.99935 1.16699C6.67852 1.16699 6.41602 1.42949 6.41602 1.75033V6.41699H1.74935C1.42852 6.41699 1.16602 6.67949 1.16602 7.00033C1.16602 7.32116 1.42852 7.58366 1.74935 7.58366H6.41602V12.2503C6.41602 12.5712 6.67852 12.8337 6.99935 12.8337C7.32018 12.8337 7.58268 12.5712 7.58268 12.2503V7.58366H12.2493C12.5702 7.58366 12.8327 7.32116 12.8327 7.00033C12.8327 6.67949 12.5702 6.41699 12.2493 6.41699H7.58268V1.75033C7.58268 1.42949 7.32018 1.16699 6.99935 1.16699Z"
                                    fill="white"/>
                            </svg>
                            <div class="pv-button-style" style="color: #FFF">Create product group</div>
                        </div>
                    </div>
                </div>
                <Row v-else :gutter="[14,14]">
                    <Col :xs="24" :lg="12" v-for="(option, index) in list_option">
                        <options-setting-item :options_setting_item_index="index"
                                              :option="option"
                                              :is_has_plan="is_has_plan_product_groups"
                                              @show_toast="show_toast"
                                              :mode="'product_group'"
                                              :key="discardState"
                                              @openProductManagement="openProductManagement"
                                              @openDeleteProduct="openDeleteProduct"
                                              @openModalUploadSwatch="openModalUploadSwatch"
                                              @selectDisplayStyle="selectDisplayStyle"
                                              @selectDisplayStyleCollectionPage="selectDisplayStyleCollectionPage"
                                              @selectOptionImages="selectOptionImages"/>
                    </Col>
                </Row>
            </div>
        </div>
        <Modal :title="`Upload Swatch | ${editOption.name}`" centered v-model:visible="modalUploadSwatch"
               @cancel="closeUploadSwatch" class="pv-modal pv-product-select"
               style="width: 50%; min-width: 700px; border-radius: 6px">
            <template #footer style="display: flex">
                <div class="ant-btn pv-btn-cancel" @click="closeUploadSwatch">Close</div>
                <div class="ant-btn ant-btn-primary pv-btn-submit" @click="uploadSwatch" style="color: #FDFDFD">
                    Update
                </div>
            </template>
            <div class="pv-flex-column" style="width: 100%" v-for="item in temp_list_option_data_img">
                <div v-for="(variant, index) in editOption.values.list_value" v-if="editOption">
                    <div v-if="variant.value === item.variant_option_value"
                         style="margin-bottom: 16px">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 16px">
                            <div class="pv-value-of-variant-option">{{ variant.name }}</div>
                        </div>
                        <RadioGroup v-model:value="item.option_swatch">
                            <div style="display: flex; gap: 16px">
                                <div class="flex-column-gap8 pv-option-upload-block"
                                     :style="{opacity: item.option_swatch === 'color' ? 1 : 0.7}">
                                    <div class="pv-option-title">
                                        <Radio value="color"/>
                                        <div class="option-title">Choose Color</div>
                                    </div>
                                    <div
                                        :class="validateColorCode(item.color_code) || item.option_swatch !== 'color' ? '' : 'pv-input-error'"
                                        class="option-block">
                                        <div class="wrap-input-color" v-if="item.option_swatch === 'color'">
                                            <input v-model="item.color_code" class="pv-input-large pv-input-color"
                                                   style="width: 60px !important; cursor: pointer" type="color">
                                        </div>
                                        <div v-if="item.option_swatch !== 'color'" class="wrap-input-color"
                                             :style="{background: item.color_code, cursor: 'not-allowed'}">
                                        </div>
                                        <input v-model="item.color_code" style="height: 38px" type="text"
                                               class="pv-input-mini pv-input-bundle-name">
                                    </div>
                                </div>
                                <div class="flex-column-gap8 pv-option-upload-block"
                                     :style="{opacity: item.option_swatch === 'upload' ? 1 : 0.7}">
                                    <div class="pv-option-title">
                                        <Radio value="upload"/>
                                        <div class="option-title">Upload an image</div>
                                    </div>
                                    <input @change="handleFileChange(variant.name, item)" type="file"
                                           style="display: none"
                                           :id="`uploadFileSwatch${index}`" accept="image/*">
                                    <div v-if="'imgData' in item || item.upload_img_url"
                                         :style="{cursor: item.option_swatch === 'upload' ? 'pointer' : 'not-allowed'}"
                                         class="pv-upload-block">
                                        <label :for="item.option_swatch === 'upload' ? `uploadFileSwatch${index}` : ''"
                                               style="overflow: hidden" class="btn-upload-file-swatch pv-input-mini"
                                               v-if="'imgData' in item">
                                            <img :src="item.imgData" alt="">
                                            <div class="pv-img-name">{{ item.imgName }}</div>
                                        </label>
                                        <label :for="item.option_swatch === 'upload' ? `uploadFileSwatch${index}` : ''"
                                               style="overflow: hidden"
                                               class="btn-upload-file-swatch pv-input-mini"
                                               v-if="item.upload_img_url && !('imgData' in item)">
                                            <img :src="item.upload_img_url" alt="">
                                            <div class="pv-img-name">
                                                {{
                                                    item.upload_img_url.split('/')[item.upload_img_url.split('/').length - 1]
                                                }}
                                            </div>
                                        </label>
                                        <DeleteOutlined class="pv-delete-img" @click="deleteImage(item)"/>
                                    </div>
                                    <label :for="item.option_swatch === 'upload' ? `uploadFileSwatch${index}` : ''"
                                           :style="{cursor: item.option_swatch === 'upload' ? 'pointer' : 'not-allowed'}"
                                           class="btn-upload-file-swatch pv-input-mini"
                                           :class="item.option_swatch === 'upload' && !('imgName' in item) ? 'pv-input-error' : ''"
                                           v-if="!('imgData' in item) && !(item.upload_img_url)">
                                        <svg width="19" height="18" viewBox="0 0 19 18" fill="none"
                                             xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M16.0835 11.25V12.15C16.0835 13.4101 16.0835 14.0402 15.8383 14.5215C15.6225 14.9448 15.2783 15.289 14.855 15.5048C14.3737 15.75 13.7436 15.75 12.4835 15.75H6.1835C4.92338 15.75 4.29332 15.75 3.81202 15.5048C3.38865 15.289 3.04445 14.9448 2.82873 14.5215C2.5835 14.0402 2.5835 13.4101 2.5835 12.15V11.25M13.0835 6L9.3335 2.25M9.3335 2.25L5.5835 6M9.3335 2.25V11.25"
                                                stroke="#3A3A3C" stroke-width="1.8" stroke-linecap="round"
                                                stroke-linejoin="round"/>
                                        </svg>
                                        Click to upload image
                                    </label>
                                </div>
                                <div class="flex-column-gap8 pv-option-upload-block"
                                     :style="{opacity: item.option_swatch === 'add_url' ? 1 : 0.7}">
                                    <div class="pv-option-title">
                                        <Radio value="add_url"/>
                                        <div class="option-title">Add image URL</div>
                                    </div>
                                    <Input class="pv-input-mini" v-model:value="item.swatch_img_url"
                                           style="background: white"
                                           :style="{cursor: item.option_swatch === 'add_url' ? '' : 'not-allowed'}"
                                           placeholder="Basic usage" :disabled="!(item.option_swatch === 'add_url')"
                                           :class="item.option_swatch === 'add_url' && !isValidUrl(item) ? 'pv-input-error' : ''">
                                        <template #prefix>
                                            <svg width="19" height="18" viewBox="0 0 19 18" fill="none"
                                                 xmlns="http://www.w3.org/2000/svg">
                                                <g clip-path="url(#clip0_218_4058)">
                                                    <path
                                                        d="M6.2915 5.25H5.9165C3.84544 5.25 2.1665 6.92893 2.1665 9C2.1665 11.0711 3.84544 12.75 5.9165 12.75H7.4165C9.48757 12.75 11.1665 11.0711 11.1665 9M13.0415 12.75H13.4165C15.4876 12.75 17.1665 11.0711 17.1665 9C17.1665 6.92893 15.4876 5.25 13.4165 5.25H11.9165C9.84544 5.25 8.1665 6.92893 8.1665 9"
                                                        stroke="#3A3A3C" stroke-width="1.8" stroke-linecap="round"
                                                        stroke-linejoin="round"/>
                                                </g>
                                                <defs>
                                                    <clipPath id="clip0_218_4058">
                                                        <rect width="18" height="18" fill="white"
                                                              transform="translate(0.666504)"/>
                                                    </clipPath>
                                                </defs>
                                            </svg>
                                        </template>
                                    </Input>
                                </div>
                            </div>
                        </RadioGroup>
                    </div>
                </div>
            </div>
        </Modal>
        <Modal v-if="option_value_product_group !== null"
               :title="mode_product_group === 'setting' ? `Edit ${option_value_product_group.group_name}`:`Add product`"
               :maskClosable="isLoadingSearchProduct ? false : true"
               centered
               v-model:visible="modalProductSelect"
               class="pv-modal pv-product-select pv-create-product-group pv-product-group-modal"
               :closable="isLoadingSearchProduct ? false : true"
               style="width: 50%; max-width: 756px; border-radius: 6px">
            <template #footer>
                <div class="pv-loading-tag-product-group" v-if="isLoadingSearchProduct">
                    <LoadingOutlined/>
                    <span>Processing</span>
                </div>
                <div v-else>
                    <div class="pv-btn-primary pv-flex-row-center" v-if="checkInputAddProductGroup"
                         style="gap: 8px"
                         @click="confirmSelectProduct"
                         :style="isLoadingSearchProduct ? {cursor: 'not-allowed'} : {cursor: 'pointer'}">
                        <div class="pv-button-style" style="color: #FFF">Confirm</div>
                    </div>
                    <div class="pb-btn-disable pv-flex-row-center" v-else style="gap: 8px;cursor: not-allowed">
                        <div class="pv-button-style" style="color: #BFBFBF">Confirm</div>
                    </div>
                </div>
            </template>

            <div class="pv-product-select-wrapper">

                <div>
                    <div class="pv-modal-product-group">Product group name</div>
                    <Input class="pv-input pv-input-search-product"
                           placeholder="Enter a product group name"
                           v-model:value="option_value_product_group.group_name"
                           :disabled="isLoadingTagProduct">
                    </Input>
                </div>
                <div>
                    <div class="pv-modal-product-group">Option name (showed on store)</div>
                    <Input class="pv-input pv-input-search-product"
                           placeholder="Enter option name"
                           v-model:value="option_value_product_group.name"
                           :disabled="isLoadingTagProduct">
                    </Input>
                </div>
                <div>
                    <div class="pv-modal-product-group">List of products</div>
                    <Input class="pv-input pv-input-search-product"
                           v-model:value="search_query_product"
                           placeholder="Search by keyword"
                           @input="searchProduct"
                           :disabled="isLoadingTagProduct">
                        <template #prefix>
                            <SearchOutlined/>
                        </template>
                    </Input>
                    <div class="pv-product-select-list" v-if="isLoadingSearchProduct">
                        <div class="pv-product-option disabled" v-for="x in [1,2,3,4,5,6]" style="width: 100%">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                <rect width="16" height="16" rx="2" fill="#DEDEDE"/>
                                <path
                                    d="M7.10497 12.6041L7.08735 12.6217L2.6875 8.22185L4.12018 6.78917L7.10502 9.77402L11.879 5L13.3117 6.43268L7.12264 12.6218L7.10497 12.6041Z"
                                    fill="#DEDEDE"/>
                            </svg>
                            <div class="pv-product-info" style="width: calc(100% - 32px)">
                                <SkeletonInput style="width: 44px" :active="true"/>
                                <div style="width: calc(100% - 56px)">
                                    <div class="pv-product-info-title">
                                        <SkeletonInput style="width: 100%" :active="true" size="small"/>
                                    </div>
                                    <div class="pv-product-info-variant">
                                        <SkeletonInput style="width: 100px" :active="true" size="small"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="pv-product-select-list" v-else style="overflow-x: auto">
                        <div v-if="search_query_product && search_query_product!=='' && product_option.length===0"
                             class="pv-no-product">
                        <span style="font-weight: 600; font-size: 14px; line-height: 20px; color: #1C1C1E">
                            No matching products found
                        </span>
                            <span style="font-weight: 400; font-size: 12px; line-height: 18px; color: #636366">
                            Check spelling or try different keywords
                        </span>
                        </div>
                        <CheckboxGroup v-model:value="tempSelectedProductIds" style="min-width: 100%" v-else>
                            <div v-for="product in product_option" class="pv-product-option"
                                 :class="tempSelectedProductIds.includes(product.id)?'selected':tempSelectedProductIds.length >= 100 && !tempSelectedProductIds.includes(product.id)?'disabled':''"
                                 :title="product.name"
                                 @click="tagProduct(product)">
                                <Checkbox :value="product.id"
                                          :disabled="tempSelectedProductIds.length >= 100 && !tempSelectedProductIds.includes(product.id) || isLoadingTagProduct"
                                          @click.prevent="tagProductCheckBox(product)"/>
                                <div class="pv-product-info">
                                    <img alt="" class="pv-product-info-img" :src="product.img_src"/>
                                    <div>
                                        <div class="pv-product-info-title">{{ product.name }}</div>
                                    </div>
                                </div>
                            </div>
                        </CheckboxGroup>
                    </div>
                </div>
            </div>
        </Modal>
    </div>
    <div v-else style="">
        <div class="pv-flex-column" style="gap: 8px">
            <div
                style=" width: 1562px;height:1050px;background-image: url('https://app.nestscale.com/nestprdvariant/static/images/design_setting/Product group.png'); background-size: cover; background-position: center; background-repeat: no-repeat;">
            </div>
        </div>
    </div>
</template>
<script>
import {DownOutlined, LoadingOutlined, DeleteOutlined, SearchOutlined} from '@ant-design/icons-vue'
import {
    Input,
    Modal,
    notification,
    Select,
    SelectOption,
    RadioGroup,
    Radio,
    Row,
    Col, SkeletonInput,
    CheckboxGroup,
    Checkbox
} from "ant-design-vue"
import OptionsSettingItem from "./options_setting_item.vue"
import axios from "axios"
import _, {debounce} from "lodash"
import {h} from "vue"

export default {
    props: {
        closeMakeSure: Boolean,
        is_has_plan_product_groups: Boolean
    },
    data() {
        return {
            store_id: 0,
            store_name: '',
            modalUploadSwatch: false,
            isLoading: false,
            editOption: '',
            data_img: [],
            temp_list_option_data_img: [],
            list_option: [],
            list_option_data_img: [],
            temp_data_img: [],
            checkAddOption: false,
            isNullUploadSwatch: false,
            original_list_option: [],
            original_list_option_data_img: [],
            store_url: '',
            discardState: false,
            modalDisplaySetting: false,
            scrollPosition: 0,
            data: {},


            option_value_product_group: {},
            option_list_option_data_img: [],
            //product modal
            modalProductSelect: false,
            isLoadingTagProduct: false,
            search_query_product: null,
            isLoadingSearchProduct: false,
            product_option: [],
            tempSelectedProduct: {},
            tempSelectedProductIds: [],
            productSelected: {}, //chon product la thang nay

            mode_product_group: null,
            temp_list_value: [],
            edit_index: null
        }
    },
    created() {
        this.store_name = window.pv_settings.store_name
        this.store_id = window.pv_settings.store_id
    },
    unmounted() {
        document.getElementById('pv-main-container').removeEventListener('scroll', this.handleScrollOptionConfigure);
    },
    async mounted() {
        this.store_url = window.pv_settings.store_url
        this.isLoading = true
        try {
            document.getElementById('pv-main-container').addEventListener('scroll', this.handleScrollOptionConfigure);
        } catch (error) {
            console.log(error)
        }
        let self = this
        axios.post("/pv/get_product_group", {
            jsonrpc: "2.0",
            params: {
                store_url: this.store_url,
                referer: window.location.href
            }
        }).then(response => {
            var data = response.data.result
            if (data.code === 0) {
                self.data = response.data.result.data
                if (Object.keys(self.data).length > 0) {
                    self.list_option = JSON.parse(self.data['list_option'])
                    self.original_list_option = JSON.stringify(JSON.parse(self.data['list_option']))
                    self.list_option_data_img = JSON.parse(self.data['list_option_data_img'])
                    self.original_list_option_data_img = JSON.stringify(JSON.parse(self.data['list_option_data_img']))
                }
            } else if (data.code === -1) {
                if (data.error === "Time out!") {
                    self.show_toast('error', "Please login again!")
                } else {
                    self.show_toast('error', data.error)
                }
            }
            self.isLoading = false
        }).catch(function (error) {
            self.isLoading = false
            self.show_toast('error', error.message)
            console.log(error)
        });


    },
    watch: {
        isOptionChange() {
            this.$.emit('checkOptionChange', this.isOptionChange)
        }
    },
    emits: ['checkOptionChange', 'setLoadingData'],
    components: {
        Row, Col,
        SearchOutlined, CheckboxGroup, Checkbox, SkeletonInput,
        Input,
        Modal,
        Select,
        SelectOption,
        OptionsSettingItem,
        LoadingOutlined,
        DownOutlined,
        RadioGroup,
        Radio,
        DeleteOutlined
    },
    methods: {
        createIdMap(products) {
            const idMap = {};
            products.forEach(product => {
                idMap[product.id] = product.id;
            });
            return idMap;
        },
        confirmSelectProduct() {

            if (this.isLoadingSearchProduct === false) {
                if (Object.keys(this.tempSelectedProduct).length > 0) {
                    this.productSelected = JSON.parse(JSON.stringify(this.tempSelectedProduct))
                } else {
                    this.productSelected = []
                }
                let list_value = []
                if (this.mode_product_group === 'setting') {
                    let index_found = this.edit_index
                    if (index_found !== null) {
                        if (this.temp_list_value.length > 0) {
                            this.list_option[index_found].values.list_value = JSON.parse(JSON.stringify(this.temp_list_value))
                        }
                        list_value = JSON.parse(JSON.stringify(this.list_option[index_found].values.list_value))
                        Object.keys(this.productSelected).forEach(product => {
                            let index_option_data_img = this.list_option_data_img.findIndex(option_list => product === option_list.variant_option_value)
                            let index_option = list_value.findIndex(option_list => product === option_list.value)
                            if (index_option === -1) {
                                list_value.push({
                                    value: this.productSelected[product].id,
                                    name: this.productSelected[product].name
                                })
                            }
                            if (index_option_data_img === -1) {
                                this.list_option_data_img.push({
                                    name: this.productSelected[product].name,
                                    variant_option_value: this.productSelected[product].id,
                                    color_code: "#ffffff",
                                    swatch_img_url: '',
                                    variant_option_name: this.productSelected[product].name,
                                    upload_img_url: "",
                                    option_swatch: "color",
                                    product_url: this.productSelected[product].product_url
                                })
                            }
                            // product.options.forEach(option => {
                            //     option.values.forEach(value => {
                            //         let index_option_data_img = this.list_option_data_img.findIndex(option_list => option.name === option_list.variant_option_name && value === option_list.variant_option_value)
                            //         let index_option = list_value.findIndex(option_list => option.name === option_list.name && value === option_list.value)
                            //         if (index_option === -1) {
                            //             list_value.push({
                            //                 value: value,
                            //                 name: option.name
                            //             })
                            //         }
                            //         if (index_option_data_img === -1) {
                            //             this.list_option_data_img.push({
                            //                 name: `${option.name}/${value}`,
                            //                 variant_option_value: value,
                            //                 color_code: "#ffffff",
                            //                 swatch_img_url: "",
                            //                 variant_option_name: option.name,
                            //                 upload_img_url: "",
                            //                 option_swatch: "color",
                            //             })
                            //         }
                            //     })
                            // })
                        })
                        this.option_value_product_group.values.list_value = JSON.parse(JSON.stringify(list_value))
                        this.option_value_product_group.list_product = JSON.parse(JSON.stringify(this.productSelected))
                        this.list_option[index_found] = JSON.parse(JSON.stringify(this.option_value_product_group));
                    }
                } else {
                    Object.keys(this.productSelected).forEach(product => {
                        let index_find = list_value.findIndex(option_list => product === option_list.value)
                        let index_option_data_img = this.list_option_data_img.findIndex(option_list => product === option_list.variant_option_value)
                        if (index_find === -1) {
                            list_value.push({
                                value: this.productSelected[product].id,
                                name: this.productSelected[product].name
                            })
                        }
                        if (index_option_data_img === -1) {
                            this.list_option_data_img.push({
                                name: this.productSelected[product].name,
                                variant_option_value: this.productSelected[product].id,
                                color_code: "#ffffff",
                                swatch_img_url: '',
                                variant_option_name: this.productSelected[product].name,
                                upload_img_url: "",
                                option_swatch: "color",
                                product_url: this.productSelected[product].product_url
                            })
                        }

                    })
                    this.list_option.push({
                        name: this.option_value_product_group.name,
                        list_product: JSON.parse(JSON.stringify(this.productSelected)),
                        id: this.createTimeBasedId(),
                        group_name: this.option_value_product_group.group_name,
                        status: false,
                        display_style: "swatch_circle_in_square",
                        values: {
                            list_value: list_value
                        },
                        option_img: "variant_image",
                        display_type_collection_page: "swatch_circle_in_square",
                        status_collection_page: false,
                    })
                }
                this.modalProductSelect = false
                this.saveVariantOptionsStyle(`${this.option_value_product_group.group_name} ${this.option_value_product_group.name} has been created successfully.`)
            }

        },
        initTempProduct: function () {
            this.temp_list_value = this.list_option[this.edit_index].values.list_value
            this.tempSelectedProduct = {}
            this.tempSelectedProductIds = []
            if (Object.keys(this.option_value_product_group.list_product).length > 0) {
                for (let item of Object.keys(this.option_value_product_group.list_product)) {
                    this.tempSelectedProductIds.push(item)
                    this.tempSelectedProduct[item] = {
                        'id': this.option_value_product_group.list_product[item].id,
                        'name': this.option_value_product_group.list_product[item].name,
                        'handle': this.option_value_product_group.list_product[item].handle,
                        'img_src': this.option_value_product_group.list_product[item].img_src,
                        'product_url': this.option_value_product_group.list_product[item].product_url,
                        'options': this.option_value_product_group.list_product[item].options
                    }
                }
            }

        },
        tagProductCheckBox(product) {
            event.preventDefault()
        },
        createTimeBasedId() {
            return new Date().getTime();
        },
        tagProduct: function (product) {
            this.option_value_product_group.list_product = JSON.parse(JSON.stringify(this.productSelected))
            let index_found = this.edit_index

            let count = 0
            let product_data = {
                id: product.id,
                name: product.name,
                handle: product.handle,
                img_src: product.img_src,
                product_url: product.product_url,
                options: product.options
            }
            if (Object.keys(this.tempSelectedProduct).length > 0) {
                for (let temp_product of Object.keys(this.tempSelectedProduct)) {
                    if (product.id === temp_product) {
                        count += 1
                    }
                }
            }
            if (count === 0 && Object.keys(this.tempSelectedProduct).length < 100) {
                this.tempSelectedProduct[product_data.id] = product_data

                this.temp_list_value.push({
                    name: product_data.name,
                    value: product_data.id
                })
                this.tempSelectedProductIds.push(product_data.id)
            }
            if (count !== 0) {
                if (index_found !== null) {
                    this.temp_list_value = JSON.parse(JSON.stringify(this.temp_list_value.filter(i => i.value !== product.id)))
                }
                if (this.tempSelectedProduct.hasOwnProperty(product.id)) {
                    delete this.tempSelectedProduct[product.id];
                }
                // this.tempSelectedProduct = this.tempSelectedProduct.filter(i => i.id !== product.id)
                this.tempSelectedProductIds = this.tempSelectedProductIds.filter(i => i !== product.id)
            }
        },
        openProductManagement(option, index) {
            this.search_query_product = ''
            this.edit_index = index
            this.mode_product_group = 'setting'
            this.option_value_product_group = JSON.parse(JSON.stringify(option))
            this.modalProductSelect = true
            this.getProductLink()
            this.initTempProduct()
        },
        openCreateProductGroup() {
            this.search_query_product = ''
            this.mode_product_group = 'create'
            this.modalProductSelect = true
            this.getProductLink()
            this.resetProductGroupModal()
            this.checkInputAddProductGroup()
        },
        openDeleteProduct(option) {
            this.list_option = JSON.parse(JSON.stringify(this.list_option.filter(item => item.id !== option.id)));
            this.saveVariantOptionsStyle(`${option.group_name} ${option.name} has been successfully deleted.`)
        },
        resetProductGroupModal() {
            this.productSelected = []
            this.tempSelectedProduct = {}
            this.tempSelectedProductIds = []
            this.option_value_product_group = {}
            this.search_query_product = null
        },
        searchProduct: function () {
            this.getProductLink()
        },
        getProductLink: _.debounce(
            function () {
                var self = this
                var search_query_product = this.search_query_product
                this.product_option = []

                if (!this.search_query_product) {
                    search_query_product = ''
                }
                if (Object.keys(this.productSelected).length > 0) {
                    this.tempSelectedProductIds = {}
                    this.tempSelectedProductIds = JSON.parse(JSON.stringify(Object.keys(this.tempSelectedProduct)))
                }
                this.isLoadingSearchProduct = true

                axios.post("/pv/products_search", {
                    jsonrpc: "2.0",
                    params: {
                        store_url: this.store_url,
                        limit: 20,
                        query: search_query_product,
                        referer: window.location.href
                    }
                }).then(response => {
                    var data = response.data.result
                    if (data.code === 0) {
                        if (self.modalProductSelect) {
                            self.product_option = data.product_options
                        }
                    } else if (data.code === -1) {
                        if (data.error == "Time out!") {
                            self.show_toast('error', "Please login again!")
                        } else {
                            self.show_toast('error', data.error)
                        }
                    }
                    self.isLoadingSearchProduct = false
                }).catch(function (error) {
                    self.isLoadingSearchProduct = false
                    self.show_toast('error', error.message)
                    console.log(error)
                });
            }, 500
        ),
        handleScrollOptionConfigure(event) {
            this.scrollPosition = event.target.scrollTop
        },
        validateColorCode(color_code) {
            const regex = /^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/
            return regex.test(color_code)
        },
        deleteImage(item) {
            for (let e of this.temp_list_option_data_img) {
                if (item.variant_option_name === e.variant_option_name && item.variant_option_value === e.variant_option_value) {
                    delete e.imgData
                    delete e.imgName
                    e.upload_img_url = ''
                }
            }
        },
        isValidUrl(item) {
            item.isValidUrl = /(https?|ftp):\/\/[a-zA-Z0-9@:%._\\+~#?&//=]{2,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%"+~#?&//=]*)?/.test(item.swatch_img_url)
            return /(https?|ftp):\/\/[a-zA-Z0-9@:%._\\+~#?&//=]{2,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%"+~#?&//=]*)?/.test(item.swatch_img_url)
        },
        selectDisplayStyle(emit_option, value) {
            for (let option of this.list_option) {
                if (option.name === emit_option.name && emit_option.id === option.id) {
                    option.display_style = value
                }
            }
        },
        selectDisplayStyleCollectionPage(emit_option, value) {
            for (let option of this.list_option) {
                if (option.name === emit_option.name && emit_option.id === option.id) {
                    option.display_type_collection_page = value
                }
            }
        },
        selectOptionImages(emit_option, value) {
            for (let option of this.list_option) {
                if (option.name === emit_option.name && emit_option.id === option.id) {
                    option.option_img = value
                }
            }
        },

        show_toast: function (type, message, duration = 3) {
            let background = ''
            if (type === 'success') {
                background = '#52c41a'
            } else if (type === 'error') {
                background = '#F5222D'
            } else {
                background = '#E9A317'
            }
            notification[type]({
                message: message,
                duration: duration,
                placement: 'bottomRight',
                style: {
                    backgroundColor: background,
                }
            })
        },
        uploadSwatch() {
            let count = 0
            let countIsInValidUrl = 0
            let countIsInValidColorCode = 0
            for (let option_data_img of this.temp_list_option_data_img) {

                for (let variant of this.editOption.values.list_value) {
                    if (variant.value === option_data_img.variant_option_value && option_data_img.option_swatch === 'upload' && option_data_img.upload_img_url === '' && !('imgName' in option_data_img)) {
                        this.isNullUploadSwatch = true
                        break
                    }
                    if (variant.value === option_data_img.variant_option_value && option_data_img.option_swatch === 'add_url' && option_data_img.swatch_img_url === '') {
                        this.isNullUploadSwatch = true
                        break
                    }
                    if (variant.value === option_data_img.variant_option_value && option_data_img.option_swatch === 'color') {
                        count += 1
                    }
                    if (variant.value === option_data_img.variant_option_value && option_data_img.option_swatch === 'add_url' && option_data_img.swatch_img_url !== '') {
                        count += 1
                    }
                    if (variant.value === option_data_img.variant_option_value && option_data_img.option_swatch === 'upload' && option_data_img.imgName !== '') {
                        count += 1
                    }
                }
                if (count === this.editOption.values.list_value.length) {
                    this.isNullUploadSwatch = false
                }

                if ('isValidUrl' in option_data_img && !option_data_img.isValidUrl && option_data_img.option_swatch === "add_url") {
                    countIsInValidUrl += 1
                }
                if (option_data_img.option_swatch === 'color' && !this.validateColorCode(option_data_img.color_code)) {
                    countIsInValidColorCode += 1
                }
            }

            if (this.isNullUploadSwatch) {
                this.show_toast('error', 'Field(s) must not be blank!')
            } else {
                if (countIsInValidColorCode > 0) {
                    this.show_toast('error', 'Invalid color code!')
                }
                if (countIsInValidUrl > 0) {
                    this.show_toast('error', 'Invalid image URL!')
                }
                if (countIsInValidColorCode === 0 && countIsInValidUrl === 0) {

                    this.list_option_data_img = this.temp_list_option_data_img.map(object => ({...object}))
                    // for (let [index, option] of this.list_option.entries()) {
                    //     if (option.id === this.editOption.id) {
                    //         this.list_option[index] = JSON.parse(JSON.stringify(this.editOption))
                    //         break
                    //     }
                    // }

                    this.editOption = ''
                    this.modalUploadSwatch = false
                    this.show_toast('success', "Swatch of color variant has been updated successfully. Please save your edits to apply.")
                }
            }
        },
        openModalUploadSwatch(value, option, index) {
            this.temp_list_option_data_img = this.list_option_data_img.map(object => ({...object}))
            this.modalUploadSwatch = value
            this.editOption = option
            this.edit_index = index
        },
        closeUploadSwatch() {
            this.temp_list_option_data_img = []
            this.editOption = ''
            this.modalUploadSwatch = false
            this.isNullUploadSwatch = false
        },
        handleFileChange(variant, item) {
            let temp_event = event
            let file = event.target.files[0] || event.dataTransfer.files[0]
            let temp_data
            if (file.size > 5242880) {
                this.show_toast('error', 'The image size must be less than 5MB')
                return
            }
            if (!file) return
            var reader = new FileReader()
            reader.readAsDataURL(file)
            reader.onload = (e) => {
                temp_data = {
                    variant_value: variant,
                    imgName: temp_event.target.files[0].name || temp_event.dataTransfer.files[0],
                    imgData: e.target.result
                }
                item.imgData = temp_data.imgData
                item.imgName = temp_data.imgName
                if (this.temp_data_img.length > 0) {
                    let index = -1
                    for (let i = 0; i < this.temp_data_img.length; i++) {
                        if (this.temp_data_img[i].variant_value === temp_data.variant_value) {
                            index = i
                        }
                    }
                    if (index !== -1) {
                        this.temp_data_img[index].imgName = temp_data.imgName
                        this.temp_data_img[index].imgData = temp_data.imgData
                    } else {
                        this.temp_data_img.push(temp_data)
                    }
                } else {
                    this.temp_data_img.push(temp_data)
                }
            }
        },
        saveVariantOptionsStyle(message) {
            this.editOption = ''
            this.modalUploadSwatch = false
            this.$emit('setLoadingData', true)

            axios.post("/pv/save_product_group", {
                jsonrpc: 2, params: {
                    list_option: this.list_option,
                    store_url: this.store_url,
                    list_option_data_img: this.list_option_data_img,
                    referer: window.location.href
                }
            }).then(res => {
                if (res.data.result.code === 1) {
                    this.list_option_data_img = JSON.parse(res.data.result.list_option_data_img)
                    this.original_list_option_data_img = JSON.stringify(JSON.parse(res.data.result.list_option_data_img))
                    this.original_list_option = JSON.stringify(this.list_option)
                    if (message !== '') {
                        this.show_toast('success', message)
                    }

                } else {
                    console.log(res.data.result.error)
                    this.show_toast("error", "Something went wrong. Please contact the customer support")
                }
                this.$emit('setLoadingData', false)
            }).catch(error => {
                this.$emit('setLoadingData', false)
                this.show_toast("error", "Something went wrong. Please contact the customer support")
                console.log(error)
            })
            this.discardState = !this.discardState
        },
        cancelVariantOptionsStyle() {

            this.list_option = JSON.parse(this.original_list_option)
            this.list_option_data_img = JSON.parse(this.original_list_option_data_img)
            this.discardState = !this.discardState
        }
    },
    computed: {
        isOptionChange() {
            if (this.list_option.length > 0 || this.list_option_data_img.length > 0) {
                return JSON.stringify(this.list_option) !== this.original_list_option || this.original_list_option_data_img !== JSON.stringify(this.list_option_data_img)
            }
        },
        checkInputAddProductGroup() {
            if ('group_name' in this.option_value_product_group && 'name' in this.option_value_product_group) {
                return this.option_value_product_group.group_name !== '' && this.option_value_product_group.name !== '' && Object.keys(this.tempSelectedProduct).length > 1
            } else {
                return false
            }
        }
    }
}
</script>